from __future__ import annotations

import uvicorn
from fastapi import FastAPI

from routes import create_task_router
from store import TaskStore


def create_app() -> FastAPI:
    store = TaskStore()
    store.seed_demo_data()

    app = FastAPI(
        title="Training Day 3 API",
        description="Simple task management endpoints built with FastAPI.",
        version="0.1.0",
    )

    app.include_router(create_task_router(store))

    @app.get("/health", tags=["Utility"])
    def health_check() -> dict[str, str]:
        return {"status": "ok"}

    return app


app = create_app()


def main() -> None:
    uvicorn.run(app, host="127.0.0.1", port=8000)


if __name__ == "__main__":
    main()
